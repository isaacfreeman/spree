<tbody id="<%= spree_dom_id variant %>" <%= 'style="color:red;"' if variant.deleted? %> data-hook="variants_row" class="variant <%= cycle('odd', 'even')%>">

  <tr class="show">
    <td class="no-border">
      <span class="handle"></span>
    </td>
    <td id="show_product_variants_attributes_<%= variant_counter %>_sku"><%= variant.sku %></td>
    <% @product.option_types.each do |option_type| %>
      <td id="show_variant_<%= variant_counter %>_option_<%= option_type.name %>"><%= variant.option_value(option_type.name) %></td>
    <% end %>
    <td>
      <span id="show_product_variants_attributes_<%= variant_counter %>_height">
        <%= number_with_precision(variant.height, :precision => 2) %>h
      </span>
      &times;
      <span id="show_product_variants_attributes_<%= variant_counter %>_width">
        <%= number_with_precision(variant.width, :precision => 2) %>w
      </span>
      &times;
      <span id="show_product_variants_attributes_<%= variant_counter %>_depth">
        <%= number_with_precision(variant.depth, :precision => 2) %>d
      </span>
      <br />
      <span id="show_product_variants_attributes_<%= variant_counter %>_weight">
        <%= number_with_precision(variant.weight, :precision => 2) %>
      </span>
    </td>
    <td id="show_product_variants_attributes_<%= variant_counter %>_price"><%= variant.display_price.to_html %></td>
    <td class="actions">
      <%= link_to_with_icon('edit',
                            Spree.t(:edit),
                            variant.new_record? ? '#' : edit_admin_product_variant_url(@product, variant),
                            :no_text => true
                            # :remote => :true,
                            # :'data-update' => spree_dom_id(variant),
                            # :'data-action' => 'edit'
                           ) %>
      &nbsp;
      <%= link_to_with_icon('trash',
                            Spree.t(:delete),
                            admin_product_variant_url(@product, variant),
                            :no_text => true,
                            :class => "delete-resource",
                            :'data-confirm' => Spree.t(:are_you_sure),
                            :'date-action' => 'remove'
                           ) unless variant.deleted? || variant.new_record? %>
    </td>
  </tr>

  <tr class="edit" style="display: none;">
    <%= f.fields_for :variants, variant do |vf| %>
      <td>
        <span class="handle"></span>
        <%= f.hidden_field :id %>
      </td>
      <td class="sku">
        <%= render :partial => 'spree/shared/error_messages', :locals => { :target => variant } %>
        <div class="field" data-hook="sku">
          <%= vf.label :sku, Spree.t(:sku) %>
          <%= vf.text_field :sku, :class => 'fullwidth edit_field' %>
        </div>
      </td>
      <% @product.option_types.each do |option_type| %>
        <td class="option_value">
          <div id="variant_<%= variant_counter %>_option_<%= option_type.name %>" class="field field-option_value" data-hook="presentation">
            <%= label :new_variant, option_type.presentation %>
            <%= vf.collection_select 'option_value_ids', option_type.option_values, :id, :presentation,
              { :prompt => true }, { :name => "product[variants_attributes][#{vf.index}][option_value_ids][]", :class => 'select2 fullwidth edit_field' } %>
          </div>
        </td>
      <% end %>
      <td>
        <% [:weight, :height, :width, :depth].each do |field| %>
          <div class="field" data-hook="<%= field %>"><%= vf.label field, Spree.t(field) %>
            <% value = number_with_precision(variant.send(field), :precision => 2) %>
            <%= vf.text_field field, :value => value, :class => 'fullwidth edit_field' %>
          </div>
        <% end %>
      </td>
      <td>
        <div class="field" data-hook="price">
          <%= vf.label :price, Spree.t(:price) %>
          <%= vf.text_field :price, :value => number_to_currency(variant.price, :unit => ''), :class => 'fullwidth edit_field' %>
        </div>

        <div class="field" data-hook="cost_price">
          <%= vf.label :cost_price, Spree.t(:cost_price) %>
          <%= vf.text_field :cost_price, :value => number_to_currency(variant.cost_price, :unit => ''), :class => 'fullwidth' %>
        </div>

        <div class="field" data-hook="tax_category">
          <%= vf.label :tax_category_id, Spree.t(:tax_category) %>
          <%= vf.collection_select(:tax_category_id, @tax_categories, :id, :name, { :include_blank => Spree.t('match_choices.none') }, { :class => 'select2 fullwidth' }) %>
        </div>
      </td>
      <td class="actions">
        <div class="form-buttons filter-actions actions" data-hook="buttons">
          <%= link_to_with_icon('ok',
                                Spree.t('actions.continue'),
                                '#',
                                :no_text => true,
                                :'data-target' => spree_dom_id(variant)
                               ) %>
        </div>
      </td>
    </tr>
  <% end %>

</tbody>
